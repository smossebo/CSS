# CCS Security Configuration
# Comprehensive security settings for the CCS framework

# Cryptographic Settings
cryptography:
  
  # Symmetric Encryption (for message confidentiality)
  symmetric_encryption:
    algorithm: "AES-256-CBC"
    key_size: 256  # bits
    iv_size: 128   # bits
    mode: "CBC"
    padding: "PKCS7"
    
    # Key Derivation Function
    key_derivation:
      algorithm: "PBKDF2"
      hash_function: "SHA256"
      iterations: 100000
      salt_size: 16  # bytes
      
    # Key Management
    key_management:
      rotation_interval: "30d"  # Rotate keys every 30 days
      max_key_usage: 1000  # Maximum encryptions per key
      key_storage: "encrypted_keyring"
      
  # Message Authentication (for integrity)
  message_authentication:
    algorithm: "HMAC"
    hash_function: "SHA256"
    tag_size: 256  # bits
    
    # HMAC Key Management
    hmac_key:
      derivation: "independent_from_encryption"
      rotation: "sync_with_encryption"
      
  # Cryptographic Hash Functions
  hash_functions:
    primary: "SHA256"
    alternatives: ["SHA512", "BLAKE2b", "SHA3-256"]
    output_sizes:
      SHA256: 256
      SHA512: 512
      BLAKE2b: "256-512"
      SHA3-256: 256
      
  # Random Number Generation
  random:
    source: "os.urandom"
    min_entropy: 256  # bits
    reseed_interval: 1000  # operations

# Protocol Security Settings
protocol_security:
  
  # Protocol Space Security
  protocol_space:
    min_size: 480  # Minimum protocol combinations
    expansion_factor: 1.5  # Allow 50% expansion
    validation_required: true
    
  # Protocol Exchange Security
  protocol_exchange:
    method: "public_key_encryption"
    algorithm: "RSA-OAEP"
    key_size: 2048  # bits
    padding: "OAEP"
    
    # Alternative: pre-shared through secure channel
    alternatives:
      - "pre_shared_symmetric"
      - "diffie_hellman"
      - "quantum_safe"
      
  # Protocol Validation
  validation:
    checksum: "SHA256"
    signature: "RSA-PSS"
    timestamp_validation: true
    replay_protection: true
    max_age: 3600  # 1 hour maximum

# Steganographic Security
steganographic_security:
  
  # Undetectability Measures
  undetectability:
    statistical_tests:
      - "chi_square"
      - "rs_analysis"
      - "sample_pairs"
      - "histogram_analysis"
      
    machine_learning_resistance:
      features_to_randomize:
        - "file_selection_pattern"
        - "timing_pattern"
        - "folder_access_pattern"
        
    plausible_deniability:
      decoy_files:
        enabled: true
        min_count: 3
        max_count: 10
        content: "random_but_plausible"
        
      normal_operations:
        simulate_normal_access: true
        business_hours_only: false
        random_delays: true
        
  # Capacity-Security Trade-off Management
  capacity_security:
    max_capacity_per_folder: "log2(M)"  # Theoretical maximum
    security_overhead: 0.1  # 10% capacity reserved for security
    adaptive_scaling: true
    
  # Error Tolerance
  error_tolerance:
    max_file_changes: 0.3  # Tolerate up to 30% file changes
    recovery_attempts: 3
    graceful_degradation: true

# Access Control and Authentication
access_control:
  
  # Cloud Provider Authentication
  cloud_auth:
    methods:
      oauth2:
        enabled: true
        providers: ["google", "microsoft", "dropbox"]
        scopes: ["read", "write", "metadata"]
        
      api_key:
        enabled: true
        rotation: "30d"
        
      service_account:
        enabled: false
        use_case: "enterprise"
        
    # Session Management
    session:
      timeout: 3600  # 1 hour
      refresh: true
      concurrent_sessions: 3
      
  # Local Authentication (for stego-key)
  local_auth:
    method: "password_based"
    key_derivation: "argon2id"
    parameters:
      time_cost: 3
      memory_cost: 65536  # 64MB
      parallelism: 4
      
    # Biometric alternatives
    alternatives:
      - "biometric"
      - "hardware_token"
      - "smart_card"

# Network Security
network_security:
  
  # Transport Layer Security
  transport:
    enforce_tls: true
    min_version: "TLSv1.2"
    preferred_ciphers:
      - "ECDHE-RSA-AES256-GCM-SHA384"
      - "ECDHE-ECDSA-AES256-GCM-SHA384"
      - "DHE-RSA-AES256-GCM-SHA384"
      
  # API Security
  api_security:
    rate_limiting:
      enabled: true
      requests_per_minute: 60
      burst_limit: 10
      
    request_signing:
      enabled: true
      algorithm: "HMAC-SHA256"
      
    input_validation:
      enabled: true
      max_file_size: 104857600  # 100MB
      allowed_extensions: [".txt", ".pdf", ".docx", ".jpg", ".png", ".mp4", ".zip"]

# Audit and Logging
audit_logging:
  
  # What to log
  events:
    - "embedding_operations"
    - "extraction_operations"
    - "protocol_changes"
    - "security_events"
    - "error_conditions"
    - "access_attempts"
    
  # Log characteristics
  characteristics:
    format: "json_structured"
    retention: "90d"
    encryption: "at_rest"
    integrity: "hmac_protected"
    
  # Privacy considerations
  privacy:
    anonymize_identifiers: true
    mask_sensitive_data: true
    log_minimization: true

# Compliance and Standards
compliance:
  
  # Cryptographic Standards
  standards:
    nist: true
    fips_140_2: false
    common_criteria: false
    
  # Data Protection Regulations
  regulations:
    gdpr:
      enabled: true
      data_minimization: true
      right_to_be_forgotten: true
      
    hipaa:
      enabled: false  # Configure as needed
      
    ccpa:
      enabled: false  # Configure as needed
      
  # Industry Standards
  industry:
    iso_27001: false
    soc_2: false
    pci_dss: false

# Threat Mitigation
threat_mitigation:
  
  # Common Attacks
  attacks:
    brute_force:
      protection: "rate_limiting"
      max_attempts: 10
      lockout_duration: 3600  # 1 hour
      
    replay_attacks:
      protection: "timestamps_nonces"
      max_time_skew: 300  # 5 minutes
      
    side_channel:
      protection: "constant_time_operations"
      
    protocol_discovery:
      protection: "large_protocol_space"
      min_space_size: 480
      
  # Incident Response
  incident_response:
    automated_response: true
    notification_channels: ["email", "sms", "dashboard"]
    escalation_policy: "three_tier"
    
  # Disaster Recovery
  disaster_recovery:
    backup_frequency: "daily"
    recovery_point_objective: "24h"
    recovery_time_objective: "4h"

# Performance-Security Trade-offs
performance_security:
  
  # Configurable trade-offs
  trade_offs:
    - name: "encryption_strength"
      options:
        high: "AES-256-GCM"
        medium: "AES-128-GCM"
        low: "ChaCha20"
        
    - name: "hash_function"
      options:
        high: "SHA512"
        medium: "SHA256"
        low: "BLAKE2s"
        
    - name: "key_derivation"
      options:
        high: "argon2id"
        medium: "PBKDF2-SHA256"
        low: "PBKDF2-SHA1"
        
  # Adaptive settings
  adaptive:
    enabled: true
    metrics:
      - "available_processing_power"
      - "network_bandwidth"
      - "security_threat_level"
      
  # Resource limits
  resource_limits:
    max_memory: 268435456  # 256MB
    max_cpu_time: 30  # seconds
    max_network_usage: 104857600  # 100MB

# Default Security Profile
default_profiles:
  
  # Profile selection
  profiles:
    maximum_security:
      description: "Maximum security, lower performance"
      encryption: "AES-256-GCM"
      kdf: "argon2id"
      hash: "SHA512"
      protocol_space: "expanded"
      
    balanced:
      description: "Balanced security and performance"
      encryption: "AES-256-CBC"
      kdf: "PBKDF2-SHA256"
      hash: "SHA256"
      protocol_space: "standard"
      
    performance:
      description: "Higher performance, adequate security"
      encryption: "AES-128-GCM"
      kdf: "PBKDF2-SHA1"
      hash: "BLAKE2s"
      protocol_space: "minimal"
      
  # Default selection
  default: "balanced"
  environment_based_selection: true
